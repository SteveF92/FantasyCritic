DROP VIEW IF EXISTS `vw_discord_leaguechannel`;

DROP VIEW IF EXISTS `vw_utility_unusedgames`;
CREATE ALGORITHM=UNDEFINED SQL SECURITY DEFINER VIEW `vw_utility_unusedgames` AS select `tbl_mastergame`.`MasterGameID` AS `MasterGameID`,`tbl_mastergame`.`GameName` AS `GameName`,`tbl_mastergame`.`EstimatedReleaseDate` AS `EstimatedReleaseDate`,`tbl_mastergame`.`MinimumReleaseDate` AS `MinimumReleaseDate`,`tbl_mastergame`.`MaximumReleaseDate` AS `MaximumReleaseDate`,`tbl_mastergame`.`EarlyAccessReleaseDate` AS `EarlyAccessReleaseDate`,`tbl_mastergame`.`InternationalReleaseDate` AS `InternationalReleaseDate`,`tbl_mastergame`.`AnnouncementDate` AS `AnnouncementDate`,`tbl_mastergame`.`ReleaseDate` AS `ReleaseDate`,`tbl_mastergame`.`OpenCriticID` AS `OpenCriticID`,`tbl_mastergame`.`GGToken` AS `GGToken`,`tbl_mastergame`.`CriticScore` AS `CriticScore`,`tbl_mastergame`.`HasAnyReviews` AS `HasAnyReviews`,`tbl_mastergame`.`Notes` AS `Notes`,`tbl_mastergame`.`BoxartFileName` AS `BoxartFileName`,`tbl_mastergame`.`GGCoverArtFileName` AS `GGCoverArtFileName`,`tbl_mastergame`.`FirstCriticScoreTimestamp` AS `FirstCriticScoreTimestamp`,`tbl_mastergame`.`DoNotRefreshDate` AS `DoNotRefreshDate`,`tbl_mastergame`.`DoNotRefreshAnything` AS `DoNotRefreshAnything`,`tbl_mastergame`.`UseSimpleEligibility` AS `UseSimpleEligibility`,`tbl_mastergame`.`DelayContention` AS `DelayContention`,`tbl_mastergame`.`AddedTimestamp` AS `AddedTimestamp`,`tbl_mastergame`.`AddedByUserID` AS `AddedByUserID` from `tbl_mastergame` where `tbl_mastergame`.`MasterGameID` in (select distinct `tbl_league_publishergame`.`MasterGameID` from `tbl_league_publishergame` where (`tbl_league_publishergame`.`MasterGameID` is not null) union select distinct `tbl_royale_publishergame`.`MasterGameID` from `tbl_royale_publishergame` union select distinct `tbl_league_pickupbid`.`MasterGameID` from `tbl_league_pickupbid` union select distinct `tbl_league_droprequest`.`MasterGameID` from `tbl_league_droprequest`) is FALSE;

ALTER TABLE `tbl_conference_activeplayer`
	DROP FOREIGN KEY `tbl_`;
ALTER TABLE `tbl_conference_activeplayer`
	ADD CONSTRAINT `FK_tbl_conference_activeplayer_tbl_conference_hasuser` FOREIGN KEY (`ConferenceID`, `UserID`) REFERENCES `tbl_conference_hasuser` (`ConferenceID`, `UserID`) ON UPDATE NO ACTION ON DELETE NO ACTION;